<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Documentation for Visper</title>
  <link rel="stylesheet" href="visper.css">
</head>

<body>
<h1 href='intro'><center>Background of the models implemented in Visper</center></h1>
<p>Visper works always in the harmonic approximation and does not account for the Jahn-Teller effect.
    If this is not valid of effects due to non-linearities should be described, this program can not be used for it.
    However, there are different levels of approximation available, requireing different amounts of input-data.
    These models are specified in Visper by the names:
<ul>
   <li><b>HR</b>: Huang-Rhys. In this model, the <a href="#HR">HR-factors</a>
        and corresponding frequencies need to be given and Visper computes the FC-progression for this.</li>
   <li><b>FC</b>: (normal) Franck-Condon. It uses Franck-Condon progressions based on the shift of normal modes
        to calculate the spectrum.</li>
   <li><b>CFC</b>: Changed Franck-Condon. In addition to the shift of the modes, the change of frequencies is
       taken into account for the calculation of intensities here.</li>
   <li><b>DR</b>: Duschinsky-Rotation. In addition to CFC, here the coupling of modes in terms of rotations
       is also taken into account.</li>
   <li><b>URDR</b>: unrestricted Duschinsky-Rotation. This method is the more consistent version of DR since it
       does not make any approximation to the changing modes </li>
</ul>
</p>
<p> The models and their differences are explained below in more detail. 
It is important to note, however, that all calculations except the URDR-spectrum are performed in one-particle approximation <a href="#FC-n">(OPA)</a>.</p>

<h2>Contents</h2>
<nav role="navigation" class="table-of-contents">
   <ol>
      <li><a href="#intro">Introduction: Vibronic spectroscopy</a></li>
      <li><a href="#FC">FC-based models</a></li>
      <li><a href="#DR">DR-based models</a></li>
      <li><a href="#manipulation">Data-manipulation</a></li>
      <li><a href="#FC-n">Particle-generalisation</a></li>
   </ol>
</nav>

<h1 id="intro">Introduction: Vibronic spectroscopy</h1>
The starting point here is Fermi's Golden Rule. In Born-Oppenheimer approximation and neglecting Jahn-Teller contributions, it takes the form
   <!-- MATH
   $I\propto |\langle \phi_f|\hat{\mu}|\phi_i\rangle|^2 \sum_{n,m}\prod_k|\langle \chi^k_{f,m}|\chi^k_{i,n}\rangle|^2$
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="450" HEIGHT="30" ALIGN="MIDDLE" BORDER="0"
   SRC="FGR.png"
   ALT="$I\propto |\langle \phi_f|\hat{\mu}|\phi_i\rangle|^2 |\langle \chi_f|\chi_i\rangle|^2$"></SPAN> 
with the first term being the electronic transition dipole moment (which is not taken into account here).
The overlap integrals in the sum thereafter are the overlap of nuclear wave functions, hence the vibronic progression where k denotes 
the vibrational modes and n,m specify the degree of excitation in initial and final state respectively.
<p>The nuclear wave functions are approximated as harmonic oscillators here.
   This is valid as long as the modes m and n are not too large.</p>

<h2>FC-progression (model <b>FC</b>)</h2>
In the simplest picture one assumes that the normal modes coincide in both electronic states.
This means that the curvature of the harmonic oscillator (hence the frequency) is the same 
and there is just a shift of the equilibrium position.
This yields a transition probability from initial state i to final state f of 
<p>
   <!-- MATH
   \[I^k_{m,n}=|\langle \chi^k_{f,m}|\chi^k_{i,n}\rangle|^2=e^{-\text{HR(k)}^2}\left|\sum_{i=0}^n\sum_{j=0}^m(-1)^i 
          \frac{HR(k)^{i+j}}{j!i!}\frac{n!}{(n-i)!}\sqrt{\frac{n!m!}{(n-i)!(m-j)!}}\delta(m-j,n-i)\right|^2\]
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="850" HEIGHT="70" ALIGN="TOP" BORDER="0"
   SRC="HR_base.png"
   ALT="\[I^k_{m,n}=|\langle \chi_{f,m}|\chi_{i,n}\rangle|^2=e^{-\text{HR(k)}^2}\left|\sum_{i=0}^n\sum_{j=0}^m(-1)^i 
      \frac{HR(k)^{i+j}}{j!i!}\frac{n!}{(n-i)!}\sqrt{\frac{n!m!}{(n-i)!(m-j)!}}\delta(m-j,n-i)\right|^2\]"></SPAN> 
</p>
where HR(k) is the Huang-Rhys factor specifying the shift of normal modes.
The above formula yields the famous Poisson profile.</p>

<h2>FC-progression advanced (model <b>CFC</b>)</h2>
In real applications, the frequencies of initial and final state in general do not coincide and hence the wave function of vibronic states 
changes its spacial extend, leading to a different overlap integral.
Usually, electronically excited states are loser bound and hence the curvature becomes less steep. 
If one accounts for the smoother wave function in the overlap integral,
the transition probability can be no more written in a closed form but is described by 
<!--MATH\[ I^k_{m,n}=|R^k_{m,n}|^2\]-->
   <SPAN CLASS="MATH"><IMG
   WIDTH="150" HEIGHT="28" ALIGN="TOP" BORDER="0"
   SRC="CFC_R.png"
   ALT="\[ I^k_{m,n}=|R^k_{m,n}|^2\]"></SPAN> 
   where 
<p>
   <!-- MATH
      \[ R^k_{m,n+1}=\frac{1}{(1+\delta^2)\sqrt{2(n+1)}}\left( 2\delta\sqrt{2m} R_{m-1,n}-2\delta D R_{m,n}-(\delta^2-1)\sqrt{2n}R_{m,n-1}\right) \]
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="850" HEIGHT="60" ALIGN="TOP" BORDER="0"
   SRC="CFC_relation1.png"
   ALT="\[ R^k_{m,n+1}=\frac{1}{(1+\delta^2)\sqrt{2(n+1)}}\left( 2\delta\sqrt{2m} R_{m-1,n}-2\delta D R_{m,n}-(\delta^2-1)\sqrt{2n}R_{m,n-1}\right) \]"></SPAN> 
</p>
<p>
   <!-- MATH
      \[ R^k_{m+1,n}=\frac{1}{(1+\delta^2)\sqrt{2(m+1)}}\left( 2\delta\sqrt{2n} R_{m,n-1}+2\delta D R_{m,n}+(\delta^2-1)\sqrt{2m}R_{m-1,n}\right) \]
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="850" HEIGHT="60" ALIGN="TOP" BORDER="0"
   SRC="CFC_relation2.png"
   ALT="\[ R^k_{m+1,n}=\frac{1}{(1+\delta^2)\sqrt{2(m+1)}}\left( 2\delta\sqrt{2n} R_{m,n-1}+2\delta D R_{m,n}+(\delta^2-1)\sqrt{2m}R_{m-1,n}\right) \]"></SPAN> 
</p>
with
<!--MATH $ \delta=\frac{\omega_f}{\omega_i} $ -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="100" HEIGHT="28" ALIGN="TOP" BORDER="0"
   SRC="cfc_delta.png"
   ALT="$ \delta=\frac{\omega_f}{\omega_i} $"></SPAN> 
   being the ratio of final state frequency and initial states frequency of the particular mode and
<!--MATH $ D=\sqrt{2}HR(k) $ -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="150" HEIGHT="28" ALIGN="TOP" BORDER="0"
   SRC="cfc_hr.png"
   ALT="$D=\sqrt{2}HR(k) $"></SPAN> 
   the scaled HR-factor.
   Finally, for correct normalisation, the purely electronic transition is
<!--MATH $ R_{0,0}=\sqrt{\frac{2\delta}{1+\delta^2}} e^{\frac 12 \frac{D^2}{1+\delta^2}} $ -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="160" HEIGHT="32" ALIGN="TOP" BORDER="0"
   SRC="cfc_r00.png"
   ALT="$R_{0,0}=\sqrt{\frac{2\delta}{1+\delta^2}} e^{\frac 12 \frac{D^2}{1+\delta^2}} $"></SPAN>.

<h2>Duschinsky rotation (model <b>URDR</b>)</h2>
The Franck-Condon model has one further effect that is not taken into account in any of the above models: If considering two modes,
the potential energy surface is a two-dimensional hyperbolic function that has different stiffness in the two directions.
Now it may happen that in the final state the normal modes are linear combinations of those in inital state and by this the hyperbel will
be rotated with respect to the ground state (see adjacent graph).
<p>
   <IMG SRC="DR_explain.png" ALT="figure showing the Duschinsky rotation for two modes." style="float:right;WIDTH:300px">
In the graph on the right hand side, the initial state is shown in blue. 
Since the final state (red) is rotated, both vibronic states couple with each other or, in other words, there is no full correspondence
between the vibrational states in initial and final electronic state.
This means first, that the one-particle picture is not applicable here and further, the product structure exploited above can not be conserved
in this model, making the calculations much more demanding.
</p>
<p> 
For this case we can write a recursive formula similar to the CFC-case.
However, it has a complex shape and a larger number of quantities need to be defined.
The interested reader may have a look at <cite>P.T. Ruhoff and M.A. Ratner, "Algorithms for Computing Franck-Condon Overlap integrals" Intern. J. Quant. Chem. 77, 383-390 (2000)</cite>
where these equations are explained in more detail.
</p>

<h1 id="FC">FC-based models</h1>
<p> Within Visper, the HR-factors are computed as
   <!-- MATH
   $HR=\frac 12 \Delta^2 f$
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="130" HEIGHT="40" ALIGN="TOP" BORDER="0"
   SRC="img10.png"
   ALT="$ HR=\frac 12 \Delta^2 f$"></SPAN> 
   where
   <SPAN CLASS="MATH"><IMG
   WIDTH="30" HEIGHT="20" ALIGN="BOTTOM" BORDER="0"
   SRC="img11.png"
   ALT="$ \Delta$"></SPAN> 
   is the shift of normal modes. 
   This can be computed in two ways: Either from the shift of Cartesian coordinates
   <SPAN CLASS="MATH"><IMG
   WIDTH="40" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
   SRC="deltax.png"
   ALT="$ \Delta X$"></SPAN> 
   using the formula
      <!-- MATH
      $\vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}$
      -->
      <SPAN CLASS="MATH"><IMG
      WIDTH="150" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
      SRC="shift.png"
      ALT="$ \vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$"></SPAN>.
   Alternatively, it can be calculated from the gradient g as
   <SPAN CLASS="MATH"><IMG
   WIDTH="111" HEIGHT="35" ALIGN="TOP" BORDER="0"
   SRC="grad.png"
   ALT="$ \Delta=g\frac{1}{f^2\sqrt{2}}$"></SPAN> 
   where the gradient is evaluated at the initial states equilibrium geometry.
   </p>
<table>
   <tr>
   <td>
   <IMG SRC="HR.png" ALT="graphical clarification of the two concepts"  width=100%; >
   </td>
   <td>
      <p> If both electronic states are given in their equilibrium geometry, the Cartesian shift can be easily
         computed and transformed to the shift of normal modes via
      <!-- MATH
      $\vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$
      -->
         <SPAN CLASS="MATH"><IMG
         WIDTH="167" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
         SRC="img17.png"
         ALT="$ \vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$"></SPAN>.
      </p>
      <p>On the other hand, the shift can be infered if both states are given in the initial states
         equilibrium geometry given the gradient of the final state and its frequency.</p>
   </td>
   <tr>
</table>
<p>Visper by default uses the shift to determine HR-factors. If the shift is too small or the keyword 
   <it>gradient</it> is given in the list of options, it will seek informations on the gradient.</p>

<h3 id="HR-m,s">FC</h3>
<p> Calculations with this model compute the vibronic transitions as described <a href="HR">above</a>.
    In addition to the Poisson distribution known for FC-progressions, also transitions from vibrationally
    excited initial levels are computed, changing the behaviour a bit.</p>

<h3 id="HR-m,c">CFC</h3>
   <p> This method works similar to that shown <a href="HR-m,s">above</a> but takes explicitly into account
    that the frequencies of electronic states don't coincide and hence the overlap is different.</p>
   <p> advantages of this method
   <ul class="navbar">
      <li> more exact results since additional effects are taken into account
      <li> structure of the spectrum can change due to lifted degeneracies
   </ul>
   <p> disadvantages of this method
   <ul class="navbar">
      <li> For larger molecules this method can take longer because the HR-factors are calculated iteratively
      <li> for many (large) systems the frequencies are expected to be very close to each other
   </ul>

<h1 id="DR">Models in the Duschinsky picture</h1>
   Taking Duschinsky-rotation into account leads to some problems by applying further 
   approximations such as the one-particle approximation (OPA); but the full calculation is 
   not feasible (or at least not wanted) for some molecules. 
   It turned out that the main problem is that one can not simply assign the vibrational modes 
   to each other since the modes in excited state are different from those in ground state
   Therefore Visper has four models with differently strong approximations:
<h3 id="DR-m,s">Simple</h3>
   In this simple model, one simply neglects that the modes do not coincide, but also that 
   the order of modes may have changed and applies OPA to it.
   This can lead to unreasonable results and hence this method should never be used.
<h3 id="DR-m,u">URDR</h3>
   Here no one-particle approximation is applied. Instead the number of normal modes taken into 
   account is truncated as it is done in the Franck-Condon scheme.
   As in the Franck-Condon scheme, the modes taken into account explicitly are chosen by the size 
   of the respective shift. But for these modes, the sub-system is
   calculated in full scheme.

<h1 id="manipulation">Data-manipulations</h1>
<p>Some of the data given (ether calculated or given via the input-files) need some manipulation to get best results. These include:</p>
<p>Shifting and rotating the coordinates into the same frame</p>
<p>projecting out rotations and vibrations</p>
<p>assign the modes in the respective states physically.</p>

<h1 id="FC-n">Particle-approximations (Franck-Condon scheme)</h1>
   In the Franck-Condon picture, the intensity is determined by the Franck-Condon 
   factor which is, besides some factors,
   .
   Hence the spectrum can be calculated easily from a one-particle spectrum, if one 
   knows all the intensity, frequency and changing mode for all transitions in one-particle approximation.
   <p> The full FC-spectrum can be calculated exactly, if the option <tt> to nPA: m </tt> 
   is set with <tt> m </tt> is not lower than 3*N-6 and the threshold for the HR-factors is set to <tt>0</tt>.

</body>
</html>
