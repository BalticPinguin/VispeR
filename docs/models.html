<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Documentation for Visper</title>
  <link rel="stylesheet" href="visper.css">
</head>

<body>
<h1 href='intro'><center>Background of the models implemented in Visper</center></h1>
<p> Visper implements several models that differ in the approximations done as well as in 
    the required input-data. </p>
<p> The (admittedly cryptic) names of the models in the programme stand for
<ul>
   <li><b>HR</b>: Huang-Rhys. This model is a bit different from the others: Here, the <a href="#HR">HR-factors</a>
        and corresponding frequencies are given and Visper computes the FC-progression for this.</li>
   <li><b>FC</b>: (normal) Franck-Condon. It uses Franck-Condon progressions based on the shift of normal modes
        to calculate the spectrum.</li>
   <li><b>CFC</b>: Changed Franck-Condon. In addition to the shift of the modes, the change of frequencies is
       taken into account for the calculation of intensities as well.</li>
   <li><b>DR</b>: Duschinsky-Rotation. In addition to CFC, here the coupling of modes in terms of rotations
       is also taken into account for the frequency-calculation.</li>
   <li><b>URDR</b>: unrestricted Duschinsky-Rotation. This method is the more consistent version of DR since it
       does not make any approximation to the changing modes </li>
</ul>
</p>
<p> The models and their differences are explained below in more detail. 
It is important to note, however, that all calculations except the URDR-spectrum are performed in one-particle approximation <a href="#FC-n">(OPA)</a>.</p>

<h2>Contents</h2>
<nav role="navigation" class="table-of-contents">
   <ol>
      <li><a href="#FC">FC-based models</a></li>
      <li><a href="#DR">DR-based models</a></li>
      <li><a href="#manipulation">Data-manipulation</a></li>
      <li><a href="#FC-n">Particle-generalisation</a></li>
   </ol>
</nav>

<h1 id="HR">HR-factors</h1>
<p>Since in literature, the variable scaling the FC progression is defined not consistently, we should clarify the
term HR-factor at this point.</p>
<p> Within Visper, the HR-factor can be computed as
   <!-- MATH
   $HR=\frac 12 \Delta^2 f$
   -->
   <SPAN CLASS="MATH"><IMG
   WIDTH="100" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
   SRC="img10.png"
   ALT="$ HR=\frac 12 \Delta^2 f$"></SPAN> 
   where 
   <SPAN CLASS="MATH"><IMG
   WIDTH="19" HEIGHT="15" ALIGN="BOTTOM" BORDER="0"
   SRC="img11.png"
   ALT="$ \Delta$"></SPAN> 
   is the shift of the modes in normal coordinates
   (to be computed via <!-- here the factor 1/1.63 is not correct anymore!-->
      <!-- MATH
      $\vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$
      -->
         <SPAN CLASS="MATH"><IMG
         WIDTH="167" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
         SRC="img17.png"
         ALT="$ \vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$"></SPAN>
         using the Cartesian shift or via
      <SPAN CLASS="MATH"><IMG
      WIDTH="111" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
      SRC="img16.png"
      ALT="$ \Delta=F_{nm}\frac{1}{f^2\sqrt{2}}$"></SPAN> 
      using the gradient at the initial states equilibrium geometry).
   </p>

<h1 id="FC">FC-based models</h1>
Assuming harmonic approximation, there are two methods for determining the shift of the normal modes,
depending on the given information.
<table>
   <tr>
   <td>
   <IMG SRC="HR.png" ALT="graphical clarification of the two concepts"  width=100%; >
   </td>
   <td>
      <p> If both electronic states are given in their equilibrium geometry, the Cartesian shift can be easily
         computed and transformed to the shift of normal modes via
      <!-- MATH
      $\vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$
      -->
         <SPAN CLASS="MATH"><IMG
         WIDTH="167" HEIGHT="40" ALIGN="MIDDLE" BORDER="0"
         SRC="img17.png"
         ALT="$ \vec {\Delta}=\bm{M}\cdot \bm{L}\cdot \vec {\Delta X}\frac{1}{1.63}$"></SPAN>.
      </p>
      <p>On the other hand, the shift can be infered if both states are given in the initial states
         equilibrium geometry given the gradient of the final state and its frequency.</p>
   </td>
   <tr>
</table>
<p>Visper by default uses the shift to determine HR-factors. If the shift is too small or the keyword 
   <it>gradient</it> is given in the list of options, it will seek informations on the gradient.</p>

<h3 id="HR-m,s">FC</h3>
<p> Calculations with this model compute the vibronic transitions as described <a href="HR">above</a>.
    In addition to the Poisson distribution known for FC-progressions, also transitions from vibrationally
    excited initial levels are computed, changing the behaviour a bit.</p>

<h3 id="HR-m,c">CFC</h3>
   <p> This method works similar to that shown <a href="HR-m,s">above</a> but takes explicitly into account
    that the frequencies of electronic states don't coincide and hence the overlap is different.</p>
   <p> advantages of this method
   <ul class="navbar">
      <li> more exact results since additional effects are taken into account
      <li> structure of the spectrum can change due to lifted degeneracies
   </ul>
   <p> disadvantages of this method
   <ul class="navbar">
      <li> For larger molecules this method can take longer because the HR-factors are calculated iteratively
      <li> for many (large) systems the frequencies are expected to be very close to each other
   </ul>

<h1 id="DR">Models in the Duschinsky picture</h1>
   Taking Duschinsky-rotation into account leads to some problems by applying further 
   approximations such as the one-particle approximation (OPA); but the full calculation is 
   not feasible (or at least not wanted) for some molecules. 
   It turned out that the main problem is that one can not simply assign the vibrational modes 
   to each other since the modes in excited state are different from those in ground state
   Therefore Visper has four models with differently strong approximations:
<h3 id="DR-m,s">Simple</h3>
   In this simple model, one simply neglects that the modes do not coincide, but also that 
   the order of modes may have changed and applies OPA to it.
   This can lead to unreasonable results and hence this method should never be used.
<h3 id="DR-m,u">URDR</h3>
   Here no one-particle approximation is applied. Instead the number of normal modes taken into 
   account is truncated as it is done in the Franck-Condon scheme.
   As in the Franck-Condon scheme, the modes taken into account explicitly are chosen by the size 
   of the respective shift. But for these modes, the sub-system is
   calculated in full scheme.

<h1 id="manipulation">Data-manipulations</h1>
<p>Some of the data given (ether calculated or given via the input-files) need some manipulation to get best results. These include:</p>
<p>Shifting and rotating the coordinates into the same frame</p>
<p>projecting out rotations and vibrations</p>
<p>assign the modes in the respective states physically.</p>

<h1 id="FC-n">Particle-approximations (Franck-Condon scheme)</h1>
   In the Franck-Condon picture, the intensity is determined by the Franck-Condon 
   factor which is, besides some factors,
   .
   Hence the spectrum can be calculated easily from a one-particle spectrum, if one 
   knows all the intensity, frequency and changing mode for all transitions in one-particle approximation.
   <p> The full FC-spectrum can be calculated exactly, if the option <tt> to nPA: m </tt> 
   is set with <tt> m </tt> is not lower than 3*N-6 and the threshold for the HR-factors is set to <tt>0</tt>.

</body>
</html>
