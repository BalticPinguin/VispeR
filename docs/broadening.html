<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>broadening.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>broadening.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>filename: broadening.py</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span><span class="o">,</span> <span class="nn">getopt</span><span class="o">,</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">copy</span> <span class="kn">import</span> <span class="n">deepcopy</span> <span class="c"># for function sort(). Probably find a better function!!</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>Below are the conversion factors and fundamental constant</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">usage</span><span class="p">():</span>
   <span class="k">print</span> <span class="s">&quot;usage: broadening.py [-o file to write in | -g broadening-parameter | -i input-file | -p number of gridpoints&quot;</span><span class="p">,</span>\
	    <span class="s">&quot;| -m minimal frequency | -M maximal frequency]&quot;</span>
   <span class="k">print</span> <span class="s">&quot;alternative usage: broadening.py [-o file to write in | -g broadening-parameter | -i input-file | -gf gridfile]&quot;</span>
   <span class="k">print</span> <span class="s">&quot;if no out- or input-file is specified, the program exits.&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>This function sorts float-arrays by absolute value (lowest argument first arguments)</p>
<p><strong>PARAMETERS:</strong>
f:  array to be sorted</p>
<p><strong>RETURNS:</strong>
order of indices of f</p>
<p><strong>NOTE:</strong>
the elements of f should not exceed 3e300 (otherwise the sorting will fail) 
of indices sorted by the size of respective elements.
The sorting by the size of elemens in A (largest first) can be done by </p>
<p>index=sort(A) 
B=A[index]</p>
<p>where B will be the sorted array.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">sort</span><span class="p">(</span><span class="n">f</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
   <span class="n">tmp</span><span class="o">=</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="c">#for avoiding side effects</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">f</span><span class="p">)):</span>
      <span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">tmp</span><span class="p">))</span> <span class="c"># there can be frequencies &lt; 0 as well...</span>
      <span class="n">tmp</span><span class="p">[</span><span class="n">index</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span><span class="o">=</span><span class="mf">5e+300</span> <span class="c"># this can be considered as smaller than all elements...</span>
   <span class="k">return</span> <span class="n">index</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">handel_input</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
   <span class="n">spectfile</span><span class="o">=</span><span class="bp">None</span>
   <span class="n">gridfile</span><span class="o">=</span><span class="bp">None</span>
   <span class="n">linspectrum</span><span class="o">=</span><span class="bp">None</span>
   <span class="n">gamma</span><span class="o">=</span><span class="mi">1</span> <span class="c">#by default: only slight broadening</span>
   <span class="n">gridpt</span><span class="o">=</span><span class="mi">6000</span>
   <span class="n">omega</span><span class="o">=</span><span class="bp">None</span>
   <span class="n">minfreq</span><span class="o">=</span><span class="mi">0</span>
   <span class="n">maxfreq</span><span class="o">=</span><span class="mi">0</span>

   <span class="k">if</span> <span class="n">opts</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-h&#39;</span><span class="p">,</span> <span class="s">&#39;--help&#39;</span><span class="p">]:</span>
      <span class="n">usage</span><span class="p">()</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
   <span class="k">for</span> <span class="n">opt</span><span class="p">,</span><span class="n">s</span> <span class="ow">in</span> <span class="n">opts</span><span class="p">:</span>
      <span class="k">print</span> <span class="n">opt</span><span class="p">,</span><span class="n">s</span>
      <span class="k">if</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-o&#39;</span><span class="p">,</span> <span class="s">&#39;--out&#39;</span><span class="p">]:</span>
	 <span class="n">spectfile</span><span class="o">=</span><span class="n">s</span>
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-g&#39;</span><span class="p">,</span><span class="s">&#39;--gamma&#39;</span><span class="p">]:</span>
	 <span class="n">gamma</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-i&#39;</span><span class="p">,</span><span class="s">&#39;--input&#39;</span><span class="p">]:</span>
	 <span class="n">linspectrum</span><span class="o">=</span><span class="n">s</span> 
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-f&#39;</span><span class="p">,</span><span class="s">&#39;--gridfile&#39;</span><span class="p">]:</span>
	 <span class="n">gridfile</span><span class="o">=</span><span class="n">s</span> 
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-p&#39;</span><span class="p">,</span><span class="s">&#39;--gridpt&#39;</span><span class="p">]:</span>
	 <span class="n">gridpt</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-m&#39;</span><span class="p">,</span><span class="s">&#39;--minfreq&#39;</span><span class="p">]:</span>
	 <span class="n">minfreq</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
      <span class="k">elif</span> <span class="n">opt</span> <span class="ow">in</span> <span class="p">[</span><span class="s">&#39;-M&#39;</span><span class="p">,</span><span class="s">&#39;--maxfreq&#39;</span><span class="p">]:</span>
	 <span class="n">maxfreq</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">spectfile</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span>
      <span class="n">out</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">spectfile</span><span class="p">,</span> <span class="s">&quot;w&quot;</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span> <span class="c">#if no input is defined: senseless</span>
      <span class="n">usage</span><span class="p">()</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">linspectrum</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>read file in format of linspect</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">freq</span><span class="o">=</span><span class="p">[]</span>
      <span class="n">intens</span><span class="o">=</span><span class="p">[]</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">linspectrum</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	 <span class="n">lis</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>  <span class="c"># create a list of lists</span>
	 <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lis</span><span class="p">):</span>        <span class="c">#print the list items </span>
	    <span class="n">freq</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
	    <span class="n">intens</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
      <span class="n">linspect</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">freq</span><span class="p">)))</span>
      <span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">freq</span><span class="p">)</span>
      <span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">matrix</span><span class="p">(</span><span class="n">intens</span><span class="p">)</span>
   <span class="k">else</span><span class="p">:</span> <span class="c">#if no input is defined: senseless</span>
      <span class="n">usage</span><span class="p">()</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="k">if</span> <span class="n">gridfile</span><span class="o">!=</span><span class="bp">None</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p>read file in format of linspect</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">grid</span><span class="o">=</span><span class="p">[]</span>
      <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">gridfile</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
	 <span class="n">lis</span><span class="o">=</span><span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">f</span><span class="p">]</span>  <span class="c"># create a list of lists</span>
	 <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lis</span><span class="p">):</span>        <span class="c">#print the list items </span>
	    <span class="n">grid</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="n">omega</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">))</span>
      <span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="p">)):</span>
	 <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">grid</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="k">print</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">omega</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">linspect</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span> <span class="n">gridpt</span><span class="p">,</span> <span class="n">minfreq</span><span class="p">,</span> <span class="n">maxfreq</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      <p>This function calculates the broadened spectrum given the line spectrum,</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">outspect</span><span class="p">(</span><span class="n">argv</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>frequency-rage and output-file whose name is first argument. 
As basis-function a Lorentzian is assumed with a common width.</p>
<p><strong>PARAMETERS:</strong>
spectfile: file, the result is written in (ascii-table). 
In addition a graph is created and shown on the fly. This graph is not saved.
gridpt:    number of grid-points to be used for the calculation
linspect:  line-spectrum list (frequency, intensity) 
gamma:     broadening constant for the Lorentzians. It is the same for all peaks</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">if</span> <span class="n">argv</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
      <span class="n">argv</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
   <span class="k">try</span><span class="p">:</span>
      <span class="n">opts</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">getopt</span><span class="o">.</span><span class="n">getopt</span><span class="p">(</span><span class="n">argv</span><span class="p">,</span> <span class="s">&#39;h:o:g:i:p:m:M:f:&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&quot;help&quot;</span><span class="p">,</span><span class="s">&quot;out=&quot;</span><span class="p">,</span> <span class="s">&quot;gamma=&quot;</span><span class="p">,</span> <span class="s">&quot;input=&quot;</span><span class="p">,</span> <span class="s">&quot;gridpt=&quot;</span><span class="p">,</span> <span class="s">&quot;minfreq&quot;</span><span class="p">,</span> <span class="s">&quot;maxfreq&quot;</span><span class="p">,</span> <span class="s">&quot;gridfile&quot;</span><span class="p">])</span>
   <span class="k">except</span> <span class="n">getopt</span><span class="o">.</span><span class="n">GetoptError</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
      <span class="k">print</span><span class="p">(</span><span class="n">err</span><span class="p">)</span>
      <span class="n">usage</span><span class="p">()</span>
      <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
   <span class="n">linspect</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">out</span><span class="p">,</span> <span class="n">gamma</span><span class="p">,</span><span class="n">gridpt</span><span class="p">,</span><span class="n">minfreq</span><span class="p">,</span><span class="n">maxfreq</span><span class="o">=</span><span class="n">handel_input</span><span class="p">(</span><span class="n">opts</span><span class="p">,</span> <span class="n">args</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>sort spectrum with respect to size of elements</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">index</span><span class="o">=</span><span class="n">sort</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
   <span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">index</span><span class="p">]</span>
   <span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">index</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>find transition with minimum intensity to be respected</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">minint</span><span class="o">=</span><span class="mi">0</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">])):</span>
      <span class="k">if</span> <span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;=</span><span class="mf">0.001</span><span class="o">*</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
	 <span class="n">minint</span><span class="o">=</span><span class="n">i</span>
	 <span class="k">break</span>
   <span class="k">print</span> <span class="s">&#39;neglect&#39;</span><span class="p">,</span><span class="n">minint</span><span class="p">,</span><span class="s">&#39;transitions, use only&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">-</span><span class="n">minint</span><span class="p">,</span> <span class="s">&quot;instead.&quot;</span>
   <span class="k">print</span><span class="p">(</span><span class="s">&#39;minimal and maximal intensities:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">minint</span><span class="p">],</span> <span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>the range should be greater than the transition-frequencies</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">if</span> <span class="n">omega</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">minfreq</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
	 <span class="n">minfreq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">minint</span><span class="p">:])</span><span class="o">-</span><span class="mi">20</span><span class="o">-</span><span class="n">gamma</span>
	 <span class="n">minfreq</span><span class="o">-=</span><span class="mi">20</span><span class="o">+</span><span class="n">gamma</span>
      <span class="k">if</span> <span class="n">maxfreq</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span>
	 <span class="n">maxfreq</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">minint</span><span class="p">:])</span> <span class="o">+</span><span class="mi">20</span><span class="o">+</span><span class="n">gamma</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">minfreq</span><span class="o">=</span><span class="n">omega</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="n">maxfreq</span><span class="o">=</span><span class="n">omega</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
   <span class="k">print</span><span class="p">(</span><span class="s">&#39;maximal and minimal frequencies:</span><span class="se">\n</span><span class="s">&#39;</span><span class="p">,</span> <span class="n">maxfreq</span><span class="p">,</span> <span class="n">minfreq</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>if no other grid is defined: use linspace in range</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">if</span> <span class="n">omega</span><span class="o">==</span><span class="bp">None</span><span class="p">:</span> 
      <span class="n">omega</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">minfreq</span><span class="p">,</span><span class="n">maxfreq</span><span class="p">,</span><span class="n">gridpt</span><span class="p">)</span>
      <span class="k">print</span> <span class="s">&quot;omega is linspaced&quot;</span>
   <span class="n">spect</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>only those with high-enough intensities are respected</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">omega</span><span class="p">)):</span> 
      <span class="n">spect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="nb">sum</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">*</span><span class="n">gamma</span><span class="o">/</span><span class="p">((</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">*</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-</span><span class="n">linspect</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">])</span><span class="o">+</span><span class="n">gamma</span><span class="o">*</span><span class="n">gamma</span><span class="p">)</span>
	    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">minint</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">linspect</span><span class="p">[</span><span class="mi">1</span><span class="p">])))</span>
      <span class="k">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">spect</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
      <span class="n">out</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s">u&quot; {0}  {1}</span><span class="se">\n</span><span class="s">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">omega</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">,</span><span class="n">spect</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&quot;__main__&quot;</span><span class="p">:</span>
   <span class="n">outspect</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>

<span class="n">version</span><span class="o">=</span><span class="mf">0.0</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>End of broadeninge.py</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
