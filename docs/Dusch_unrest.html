<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html;charset=utf-8">
  <title>Dusch_unrest.py</title>
  <link rel="stylesheet" href="pycco.css">
</head>
<body>
<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>Dusch_unrest.py</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>filename: Dusch_unrest.pyx</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>include <a href="Btree.html">Btree.pyx</a></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="kn">import</span> <span class="nn">Btree</span> <span class="kn">as</span> <span class="nn">bt</span>

<span class="n">Hartree2cm_1</span><span class="o">=</span><span class="mf">219474.63</span> 
<span class="n">Threshold</span><span class="o">=</span><span class="mf">3e-10</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>This function</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">unrestricted</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">F</span><span class="p">,</span> <span class="n">Energy</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">E0</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p><strong>PARAMETERS</strong>
logging: object having as first element the mode and as second the (already opened) log-file
J:        Duschisky-matrix
K:        Displacement-Vector
f:        frequency: two-dim array (freq_initial, freq_final)
Energy:   Energy-difference of minima
N:        Max. number of excitation quanta state considered
T:        Temperature of the system
E0:       frequency of the purely electronic transition
m:        number of vibrational modes taken into account for the spectum calculation</p>
<p><strong>RETURNS</strong>
linespectrum: vibrational line-spectrum</p>
<p>K*=np.sqrt(np.pi)/2. # --&gt; do it in functions_smsc.Duschinsky now
first: resort the elements of J, K, f to make J most closely to unity</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">resort</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">J</span><span class="p">))</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">J</span><span class="p">)):</span>
      <span class="n">j</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;-</span><span class="n">J</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]:</span>
        <span class="n">resort</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>
      <span class="k">else</span><span class="p">:</span>
         <span class="n">resort</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=-</span><span class="mi">1</span>
   <span class="n">J</span><span class="o">=</span><span class="n">resort</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
   <span class="n">K</span><span class="o">=</span><span class="n">resort</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">resort</span><span class="p">)):</span>
      <span class="n">k</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argmin</span><span class="p">(</span><span class="n">resort</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
      <span class="k">if</span> <span class="n">resort</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">==-</span><span class="mi">1</span><span class="p">:</span>
         <span class="n">resort</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">k</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span> <span class="c">#use absolute value only.</span>
   <span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">resort</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>--&gt; change the following: not size of K but off-diagonal-elements of J!!! 
--&gt; if J[i][j] is large, add indices i and j to ind if they are not contained already...</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">if</span> <span class="n">m</span><span class="o">&lt;</span><span class="nb">len</span><span class="p">(</span><span class="n">J</span><span class="p">):</span> <span class="c">#this model might be more realistic!!</span>
      <span class="n">index</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">argsort</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">K</span><span class="p">),</span> <span class="n">kind</span><span class="o">=</span><span class="s">&quot;heapsort&quot;</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">ind</span><span class="o">=</span><span class="n">index</span><span class="p">[:</span><span class="n">m</span><span class="p">]</span>
      <span class="n">k</span><span class="o">=</span><span class="n">K</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
      <span class="n">j</span><span class="o">=</span><span class="n">J</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
      <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span> <span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">ind</span><span class="p">)</span> <span class="p">))</span>
      <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span>
      <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">ind</span><span class="p">]</span>
   <span class="k">else</span><span class="p">:</span>
      <span class="n">k</span><span class="o">=</span><span class="n">K</span>
      <span class="n">j</span><span class="o">=</span><span class="n">J</span>
      <span class="n">f</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span> <span class="mi">2</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="p">))</span>
      <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">F</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
      <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">F</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-5'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-5'>#</a>
      </div>
      <p>finally, calculate the Duschinsky-rotated line spectrum in this picture</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">linspect</span><span class="o">=</span><span class="n">FCf</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Energy</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">E0</span><span class="p">)</span>
   <span class="k">return</span> <span class="n">linspect</span> <span class="c">#3-dimensional array</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-6'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-6'>#</a>
      </div>
      <p>Calculates the FC-factors for given Duschinsky-effect. No restriction to OPA</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">def</span> <span class="nf">FCf</span><span class="p">(</span><span class="n">logging</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">Energy</span><span class="p">,</span> <span class="n">N</span><span class="p">,</span> <span class="n">T</span><span class="p">,</span> <span class="n">E0</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-7'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-7'>#</a>
      </div>
      <p><em>PARAMETERS:</em>
logging: object having as first element the mode and as second the (already opened) log-file
J:      Duschisky-matrix
K:      Displacement-Vector
f:      frequency: two-dim array (freq_initial, freq_final)
Energy: Energy-difference of minima
N:      Max. number of excitation quanta state considered
T:      Temperature of the system
E0:     frequency of the purely electronic transition</p>
<p>All parameters are obligatory.</p>
<p><em>RETURNS:</em>
linespectrum </p>
<p>This function calculates the overlap-integral for zero vibrations</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">def</span> <span class="nf">CalcI00</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">,</span> <span class="n">Gammap</span><span class="p">,</span> <span class="n">E</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-8'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-8'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">Tree</span><span class="o">=</span><span class="n">bt</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">))</span>
      <span class="n">Tree</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
      <span class="n">Zero</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">K</span><span class="p">))</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-9'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-9'>#</a>
      </div>
      <p>E+=(sum(Gammap)-sum(Gamma))*.5    # correct for vibrational groundstates
linespect=np.array(Tree.extract())</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">Tree</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">Zero</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.0</span><span class="p">,</span> <span class="p">(</span><span class="n">E</span><span class="p">)</span><span class="o">*</span><span class="n">Hartree2cm_1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="p">)</span> <span class="c">#sum(sum()) due to matrix</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-10'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-10'>#</a>
      </div>
      <p>I_00 transition-probability <a href="Btree.html#extract">Btree.py</a>
linespect=np.array(Tree.extract())
this is done using implicit side effects</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">lines</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
      <span class="n">freqs</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">E</span><span class="p">)</span><span class="o">*</span><span class="n">Hartree2cm_1</span><span class="p">)</span>
      <span class="n">initF</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c">#needed for boltzmann-weighing</span>
      <span class="k">return</span> <span class="n">Tree</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-11'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-11'>#</a>
      </div>
      <p>Calculates the Franck-Condon factors of an eletronic transition using the lower levels L1 and L2</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">def</span> <span class="nf">iterate</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">Energy</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-12'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-12'>#</a>
      </div>
      <p>PARAMETERS:*
1:     binary tree where i-2 quanta are excited (structure: <a href="Btree.html">Btree.py</a>
2:     binary tree where i-1 quanta are excited
nergy: Energy-difference between the states (minimal energy)
:      number of excitation-quanta
:      (2xN) frequencies of both states
:           Duschisky-rotation matrix
:           Displacement-vector</p>
<p>RETURNS:*
2:     input-parameter (needed for next iteration)
3:     new binary tree </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-13'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-13'>#</a>
      </div>
      <p>quantities for the iterative spectrum-calculation</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">npdiag</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span>
      <span class="n">Gamma</span><span class="o">=</span><span class="n">npdiag</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>               <span class="c"># in atomic units. It is equivalent to 4pi^2/h f_i</span>
      <span class="n">Gammap</span><span class="o">=</span><span class="n">npdiag</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>              <span class="c"># for initial state</span>
      <span class="n">sqGamma</span><span class="o">=</span><span class="n">npdiag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
      <span class="n">sqGammap</span><span class="o">=</span><span class="n">npdiag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
      <span class="n">unity</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">eye</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">Gamma</span><span class="p">))</span>
   
      <span class="n">TMP</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Gammap</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="p">)</span> <span class="o">+</span> <span class="n">Gamma</span><span class="p">)</span>
      <span class="n">A</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">sqGammap</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">TMP</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sqGammap</span><span class="p">)</span> <span class="o">-</span><span class="n">unity</span>
      <span class="n">b</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">sqGammap</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">unity</span> <span class="o">-</span> <span class="n">J</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">TMP</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Gammap</span><span class="p">)</span> <span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">)</span>
      <span class="n">C</span><span class="o">=</span><span class="mf">2.</span><span class="o">*</span><span class="n">sqGamma</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">TMP</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sqGammap</span><span class="p">)</span> <span class="o">-</span><span class="n">unity</span>
      <span class="n">d</span><span class="o">=-</span><span class="mf">2.</span><span class="o">*</span><span class="n">sqGamma</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">TMP</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">Gammap</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">K</span><span class="p">)))</span>
      <span class="n">E</span><span class="o">=</span><span class="mf">4.</span><span class="o">*</span><span class="n">sqGamma</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">TMP</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">J</span><span class="o">.</span><span class="n">T</span><span class="p">)</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sqGammap</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-14'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-14'>#</a>
      </div>
      <p>S=np.linalg.inv(J.T.dot(Gammap).dot(J)+Gamma)
A=2.<em>sqGammap.dot(J).dot(S).dot(J.T).dot(sqGammap)-unity
C=2.</em>sqGamma.dot(S).dot(sqGamma)-unity
E=4.<em>sqGamma.dot(S).dot(J.T).dot(sqGammap)
b=2.</em>( sqGammap.dot(K)-sqGammap.dot(J.dot(S.dot((J.T).dot(Gammap.dot(K))))) )
d=-2.*sqGamma.dot(S.dot((J.T).dot(Gammap.dot(K))))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-15'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-15'>#</a>
      </div>
      <p>initialize new tree</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">alpha</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
      <span class="n">L3</span><span class="o">=</span><span class="n">bt</span><span class="o">.</span><span class="n">Tree</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
      <span class="n">L3</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span>
      <span class="n">States</span><span class="o">=</span><span class="n">states</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span>           <span class="c"># States are all possible</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-16'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-16'>#</a>
      </div>
      <p>Calculates the frequency of respective transition including vibrational frequency</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="k">def</span> <span class="nf">freq</span><span class="p">(</span> <span class="n">E</span><span class="p">,</span> <span class="n">Gamma</span><span class="p">,</span> <span class="n">Gammap</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-17'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-17'>#</a>
      </div>
      <p><em>PARAMETERS:</em>
E:      energy-difference of states
Gamma:  vector of vibrational frequencies in inital state (in atomic units)
Gammap: vector of vibrational frequencies in final state (in atomic units)</p>
<p><em>RETURNS;</em>
frequency of respective transition</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">return</span> <span class="p">(</span><span class="n">E</span><span class="o">+</span><span class="nb">sum</span><span class="p">(</span><span class="n">Gammap</span><span class="o">-</span><span class="n">Gamma</span><span class="p">))</span><span class="o">*</span><span class="n">Hartree2cm_1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-18'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-18'>#</a>
      </div>
      <p>Find first non-zero elements in first and second half of array n</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="k">def</span> <span class="nf">FirstNonzero</span><span class="p">(</span><span class="n">n</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-19'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-19'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="n">leng</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">//</span><span class="mi">2</span>
         <span class="n">m</span><span class="o">=</span><span class="n">leng</span><span class="o">+</span><span class="mi">1</span> <span class="c">#this means there is no excitation in this state</span>
         <span class="n">mp</span><span class="o">=</span><span class="n">leng</span><span class="o">+</span><span class="mi">1</span>
         <span class="n">ni</span><span class="o">=</span><span class="n">n</span><span class="p">[:</span><span class="n">leng</span><span class="p">]</span> <span class="c">#interger division (python3-compatible)</span>
         <span class="n">nf</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">leng</span><span class="p">:]</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leng</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">ni</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
               <span class="n">m</span><span class="o">=</span><span class="n">j</span>
               <span class="k">break</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">leng</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">nf</span><span class="p">[</span><span class="n">j</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
               <span class="n">mp</span><span class="o">=</span><span class="n">j</span>
               <span class="k">break</span>
         <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">mp</span>
      
      <span class="n">npsqrt</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span>
      <span class="n">leng</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">States</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">//</span><span class="mi">2</span>
      <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">States</span><span class="p">:</span> <span class="c">#for each possible state, described by n(vector)</span>
         <span class="n">m</span><span class="p">,</span> <span class="n">mp</span><span class="o">=</span> <span class="n">FirstNonzero</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="c"># index of first-non-zero element of (initial, final) state</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-20'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-20'>#</a>
      </div>
      <p>if the 'first' excited state is in initial state: need first iteration formula</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">if</span> <span class="n">m</span><span class="o">&lt;=</span><span class="n">mp</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-21'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-21'>#</a>
      </div>
      <p>need first iteration-formula</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">n_m</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span>
            <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span> <span class="c">#n[m] is at least 1</span>
            <span class="n">Ps</span><span class="o">=</span><span class="n">L2</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-22'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-22'>#</a>
      </div>
      <p>if not math.isnan(Ps) and abs(Ps)&gt;1e-8:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="n">I_nn</span><span class="o">=</span><span class="n">b</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">Ps</span>                                     <span class="c"># first term </span>
            <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
               <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
               <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
               <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">n_m</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">A</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">Ps</span>           <span class="c"># second term</span>
               <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">leng</span><span class="p">):</span>
               <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
                  <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                  <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A</span><span class="p">[</span><span class="n">m</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">+</span><span class="n">A</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">m</span><span class="p">])</span><span class="o">*</span><span class="n">Ps</span>   <span class="c"># second term</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>                    <span class="c"># sum over respective final states</span>
               <span class="k">if</span> <span class="n">mp</span><span class="o">&gt;</span><span class="n">leng</span><span class="p">:</span>                                      <span class="c"># that means: there are no excited vibrations</span>
                  <span class="k">break</span>
               <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
                  <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                  <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="n">E</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">leng</span><span class="p">][</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">Ps</span>        <span class="c"># second term</span>
            <span class="n">n</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-23'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-23'>#</a>
      </div>
      <p>else: need the other iteration-formula</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">else</span><span class="p">:</span> 
            <span class="n">n_m</span><span class="o">=</span><span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span>
            <span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
            <span class="n">Ps</span><span class="o">=</span><span class="n">L2</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">I_nn</span><span class="o">=</span><span class="n">d</span><span class="p">[</span><span class="n">mp</span><span class="p">]</span><span class="o">*</span><span class="n">Ps</span>                                       <span class="c"># first term </span>
            <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
               <span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
               <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
               <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="n">n_m</span><span class="o">-</span><span class="mf">1.0</span><span class="p">))</span><span class="o">*</span><span class="n">C</span><span class="p">[</span><span class="n">mp</span><span class="p">][</span><span class="n">mp</span><span class="p">]</span><span class="o">*</span><span class="n">Ps</span>           <span class="c"># second term</span>
               <span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">mp</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">leng</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">n</span><span class="p">)):</span>
               <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
                  <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
                  <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">C</span><span class="p">[</span><span class="n">mp</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="n">leng</span><span class="p">]</span><span class="o">+</span>        <span class="c"># second term</span>
                              <span class="n">C</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="n">leng</span><span class="p">][</span><span class="n">mp</span><span class="p">])</span><span class="o">*</span><span class="n">Ps</span> 
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">leng</span><span class="p">):</span>                            <span class="c">#sum over respective final states</span>
               <span class="k">if</span> <span class="n">m</span><span class="o">&gt;</span><span class="n">leng</span><span class="p">:</span>                                       <span class="c"># that means: there are no excited vibrations</span>
                  <span class="k">break</span>                                         <span class="c">#actually not needed, right?</span>
               <span class="k">if</span> <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">:</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">-=</span><span class="mi">1</span>
                  <span class="n">Ps</span><span class="o">=</span><span class="n">L1</span><span class="o">.</span><span class="n">getState</span><span class="p">(</span><span class="n">n</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
                  <span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-24'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-24'>#</a>
      </div>
      <p>if not math.isnan(Ps) and abs(Ps)&gt;1e-8:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>                  <span class="n">I_nn</span><span class="o">+=</span><span class="n">npsqrt</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="mf">0.5</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">E</span><span class="p">[</span><span class="n">mp</span><span class="p">][</span><span class="n">i</span><span class="o">-</span><span class="n">leng</span><span class="p">])</span><span class="o">*</span><span class="n">Ps</span> <span class="c"># second term</span>
            <span class="n">n</span><span class="p">[</span><span class="n">mp</span><span class="o">+</span><span class="n">leng</span><span class="p">]</span><span class="o">+=</span><span class="mi">1</span>
         <span class="n">I_nn</span><span class="o">/=</span><span class="n">npsqrt</span><span class="p">(</span><span class="mf">2.</span><span class="o">*</span><span class="n">n_m</span><span class="p">)</span>
         <span class="k">assert</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">I_nn</span><span class="p">)</span> <span class="p">,</span><span class="s">&quot;I_nn is not a number! I_nn: {0}</span><span class="se">\n</span><span class="s">, n:{1}</span><span class="se">\n</span><span class="s">:&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">I_nn</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-25'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-25'>#</a>
      </div>
      <p>threshold for insertion: saves memory, since int insead of float is used</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">I_nn</span><span class="p">)</span><span class="o">&gt;</span><span class="mf">1e-8</span><span class="p">:</span>
            <span class="n">L3</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="p">[</span><span class="n">I_nn</span><span class="p">,</span> <span class="n">freq</span><span class="p">(</span><span class="n">Energy</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[:</span><span class="n">leng</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">leng</span><span class="p">:]),</span> <span class="n">freq</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">n</span><span class="p">[</span><span class="n">leng</span><span class="p">:])</span> <span class="p">])</span>
            <span class="k">print</span> <span class="s">&quot;</span><span class="si">%2i</span><span class="s">&quot;</span><span class="o">%</span><span class="nb">min</span><span class="p">(</span><span class="n">m</span><span class="p">,</span><span class="n">mp</span><span class="p">),</span> <span class="n">I_nn</span><span class="o">*</span><span class="n">I_nn</span> <span class="p">,</span> <span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n</span><span class="p">[:</span><span class="n">leng</span><span class="p">])</span><span class="o">-</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n</span><span class="p">[</span><span class="n">leng</span><span class="p">:]))</span><span class="o">*</span><span class="n">Hartree2cm_1</span><span class="p">,</span> <span class="s">&quot;    </span><span class="se">\t</span><span class="s">&quot;</span><span class="p">,</span><span class="n">n</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-26'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-26'>#</a>
      </div>
      <p>if I_nn&gt;=10:
print n, I_nn, freq(Energy, f[0]<em>n[:leng], f[1]</em>n[leng:])</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="k">return</span> <span class="n">L2</span><span class="p">,</span> <span class="n">L3</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-27'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-27'>#</a>
      </div>
      <p>This function creates all possible states having a total number of n excitations in alpha different states</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">def</span> <span class="nf">states</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-28'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-28'>#</a>
      </div>
      <p><em>PARAMETERS:</em>
alpha: number of degrees of freedom
n:     number of excitations</p>
<p><em>RETURNS:</em></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-29'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-29'>#</a>
      </div>
      <p>These functions are part of python-package: 'combinatorics' 
(download from https://pypi.python.org/pypi/Combinatorics)
unlabeled_balls_in_labeled_boxes(balls, box_sizes): This function 
returns a generator that produces all distinct distributions of indistinguishable balls
among labeled boxes with specified box sizes (capacities). This is 
a generalization of the most common formulation of the problem, where each box is
sufficiently large to accommodate all of the balls, and is an important 
example of a class of combinatorics problems called 'weak composition' problems.</p>
<p>OVERVIEW</p>
<p>This function returns a generator that produces all distinct distributions of
indistinguishable balls among labeled boxes with specified box sizes
(capacities).  This is a generalization of the most common formulation of the
problem, where each box is sufficiently large to accommodate all of the
balls, and is an important example of a class of combinatorics problems
called 'weak composition' problems.</p>
<p>CONSTRUCTOR INPUTS</p>
<p>n: the number of balls</p>
<p>box_sizes: This argument is a list of length 1 or greater.  The length of
the list corresponds to the number of boxes.  <code>box_sizes[i]</code> is a positive
integer that specifies the maximum capacity of the ith box.  If
<code>box_sizes[i]</code> equals <code>n</code> (or greater), the ith box can accommodate all <code>n</code>
balls and thus effectively has unlimited capacity.</p>
<p>ACKNOWLEDGMENT</p>
<p>I'd like to thank Chris Rebert for helping me to convert my prototype
class-based code into a generator function.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="k">def</span> <span class="nf">unlabeled_balls_in_labeled_boxes</span><span class="p">(</span><span class="n">balls</span><span class="p">,</span> <span class="n">box_sizes</span><span class="p">):</span> <span class="c">#needed for &#39;states&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-30'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-30'>#</a>
      </div>
      <p>This recursive generator function was designed to be returned by
<code>unlabeled_balls_in_labeled_boxes</code>.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">def</span> <span class="nf">_unlabeled_balls_in_labeled_boxes</span><span class="p">(</span><span class="n">balls</span><span class="p">,</span> <span class="n">box_sizes</span><span class="p">):</span> <span class="c">#needed for &#39;unlabeled_balls_in_labeled_boxes&#39; needed for &#39;states&#39;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-31'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-31'>#</a>
      </div>
      
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-32'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-32'>#</a>
      </div>
      <p>If there are no balls, all boxes must be empty:</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">if</span> <span class="ow">not</span> <span class="n">balls</span><span class="p">:</span>
               <span class="k">yield</span> <span class="nb">len</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">0</span><span class="p">,)</span>
         
            <span class="k">elif</span> <span class="nb">len</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-33'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-33'>#</a>
      </div>
      <p>If the single available box has sufficient capacity to store the balls,
there is only one possible distribution, and we return it to the caller
via <code>yield</code>.  Otherwise, the flow of control will pass to the end of the
function, triggering a <code>StopIteration</code> exception.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>               <span class="k">if</span> <span class="n">box_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">balls</span><span class="p">:</span>
                  <span class="k">yield</span> <span class="p">(</span><span class="n">balls</span><span class="p">,)</span>
      
            <span class="k">else</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-34'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-34'>#</a>
      </div>
      <p>Iterate over the number of balls in the first box (from the maximum
possible down to zero), recursively invoking the generator to distribute
the remaining balls among the remaining boxes.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>               <span class="k">for</span> <span class="n">balls_in_first_box</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span> <span class="nb">min</span><span class="p">(</span><span class="n">balls</span><span class="p">,</span> <span class="n">box_sizes</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="p">):</span>
                  <span class="n">balls_in_other_boxes</span><span class="o">=</span> <span class="n">balls</span> <span class="o">-</span> <span class="n">balls_in_first_box</span>
                  <span class="k">for</span> <span class="n">distribution_other</span> <span class="ow">in</span> <span class="n">_unlabeled_balls_in_labeled_boxes</span><span class="p">(</span>
                  <span class="n">balls_in_other_boxes</span><span class="p">,</span> <span class="n">box_sizes</span><span class="p">[</span><span class="mi">1</span><span class="p">:]):</span>
                     <span class="k">yield</span> <span class="p">(</span><span class="n">balls_in_first_box</span><span class="p">,)</span> <span class="o">+</span> <span class="n">distribution_other</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-35'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-35'>#</a>
      </div>
      <p>end three alternative blocks</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">balls</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
               <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;balls must be a non-negative integer.&quot;</span><span class="p">)</span>
         <span class="k">if</span> <span class="n">balls</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;balls must be a non-negative integer.&quot;</span><span class="p">)</span>
      
         <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">,</span><span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;box_sizes must be a non-empty list.&quot;</span><span class="p">)</span>
      
         <span class="n">capacity</span><span class="o">=</span> <span class="mi">0</span>
         <span class="k">for</span> <span class="n">size</span> <span class="ow">in</span> <span class="n">box_sizes</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">size</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
               <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s">&quot;box_sizes must contain only positive integers.&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">size</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
               <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;box_sizes must contain only positive integers.&quot;</span><span class="p">)</span>
            <span class="n">capacity</span><span class="o">+=</span> <span class="n">size</span>
      
         <span class="k">if</span> <span class="n">capacity</span> <span class="o">&lt;</span> <span class="n">balls</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s">&quot;The total capacity of the boxes is less than the &quot;</span>
            <span class="s">&quot;number of balls to be distributed.&quot;</span><span class="p">)</span>
   
         <span class="k">return</span> <span class="n">_unlabeled_balls_in_labeled_boxes</span><span class="p">(</span><span class="n">balls</span><span class="p">,</span> <span class="n">box_sizes</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-36'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-36'>#</a>
      </div>
      <p>end def _unlabeled_balls_in_labeled_boxes(balls, box_sizes)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-37'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-37'>#</a>
      </div>
      <p>States=np.zeros((math.factorial(n+alpha-1)/(math.factorial(n)*math.factorial(alpha-1)),alpha))</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">States2</span><span class="o">=</span><span class="p">[]</span>
      <span class="n">a</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">alpha</span><span class="p">)</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">a</span><span class="p">)):</span>
         <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">n</span><span class="o">*</span><span class="nb">int</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c">#create the needed list</span>
      <span class="n">i</span><span class="o">=</span><span class="mi">0</span>
      <span class="k">for</span> <span class="n">distributions</span> <span class="ow">in</span> <span class="n">unlabeled_balls_in_labeled_boxes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">a</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-38'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-38'>#</a>
      </div>
      <p>States[i]=np.matrix(distributions)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">try</span><span class="p">:</span>
            <span class="n">States2</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">distributions</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">))</span> <span class="c">#save memory!</span>
         <span class="k">except</span> <span class="ne">MemoryError</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-39'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-39'>#</a>
      </div>
      <p>if the memory is not enough: don't add further states and use what is availibleA</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>            <span class="k">print</span><span class="p">(</span><span class="s">&#39;Memory is full for state&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="s">&#39;having only&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">States2</span><span class="p">),</span><span class="s">&#39;objects in it. Use these states only.&#39;</span><span class="p">)</span>
            <span class="k">break</span> <span class="c">#in principle: do more stuff here!</span>
         <span class="n">i</span><span class="o">+=</span><span class="mi">1</span>
      <span class="k">return</span> <span class="n">States2</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-40'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-40'>#</a>
      </div>
      <p>This function creates all possible states having a total number of n excitations in alpha different states</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">def</span> <span class="nf">states2</span><span class="p">(</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-41'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-41'>#</a>
      </div>
      <p><em>PARAMETERS:</em>
alpha: number of degrees of freedom
n:     number of excitations</p>
<p><em>RETURNS:</em></p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">States</span><span class="o">=</span><span class="p">[]</span>
      <span class="n">alpha</span><span class="o">=</span><span class="n">alpha</span><span class="o">//</span><span class="mi">2</span>
      <span class="n">distributions</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">alpha</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
      <span class="k">print</span> <span class="n">n</span>
      <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">alpha</span><span class="p">):</span>
         <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
            <span class="n">distributions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">n</span><span class="o">-</span><span class="n">j</span>
            <span class="n">distributions</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">alpha</span><span class="p">]</span><span class="o">=</span><span class="n">j</span>
            <span class="n">States</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">distributions</span><span class="p">))</span> <span class="c">#save memory!</span>
            <span class="n">distributions</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
            <span class="n">distributions</span><span class="p">[</span><span class="n">i</span><span class="o">+</span><span class="n">alpha</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span>
      <span class="k">return</span> <span class="n">States</span>
   
   <span class="n">Gammap</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="c"># for initial state</span>
   <span class="n">Gamma</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c">#in atomic units. It is equivalent to 4pi^2/h f_i</span>
   <span class="n">lines</span><span class="o">=</span><span class="p">[]</span>
   <span class="n">freqs</span><span class="o">=</span><span class="p">[]</span>
   <span class="n">initF</span><span class="o">=</span><span class="p">[]</span>
   <span class="n">lineapp</span><span class="o">=</span><span class="n">lines</span><span class="o">.</span><span class="n">append</span>
   <span class="n">freqapp</span><span class="o">=</span><span class="n">freqs</span><span class="o">.</span><span class="n">append</span>
   <span class="n">initapp</span><span class="o">=</span><span class="n">initF</span><span class="o">.</span><span class="n">append</span>

   <span class="n">L2</span><span class="o">=</span><span class="n">CalcI00</span><span class="p">(</span><span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">Energy</span><span class="p">)</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-42'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-42'>#</a>
      </div>
      <p>both trees can be considered to coincide for first state. </p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">L1</span><span class="o">=</span><span class="n">L2</span> 
   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">N</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
      <span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="o">=</span><span class="n">iterate</span><span class="p">(</span><span class="n">L1</span><span class="p">,</span> <span class="n">L2</span><span class="p">,</span> <span class="n">Energy</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">J</span><span class="p">,</span> <span class="n">K</span><span class="p">)</span>
      <span class="k">if</span> <span class="n">L1</span><span class="o">==</span><span class="mi">0</span> <span class="ow">and</span> <span class="n">L2</span><span class="o">==</span><span class="mi">0</span><span class="p">:</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-43'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-43'>#</a>
      </div>
      <p>only by assert: MemoryError</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>         <span class="k">break</span> <span class="c"># kill calculation</span>
      <span class="n">spect</span><span class="o">=</span><span class="n">L2</span><span class="o">.</span><span class="n">extract</span><span class="p">()</span>
      <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">xrange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">spect</span><span class="p">)):</span>
         <span class="n">lineapp</span><span class="p">(</span><span class="n">spect</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">*</span><span class="n">spect</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>  <span class="c"># because I_nn is stored, the intensity is I_nn*I_nn</span>
         <span class="n">freqapp</span><span class="p">(</span><span class="n">spect</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>              <span class="c"># energy of respective transition </span>
         <span class="n">initapp</span><span class="p">(</span><span class="n">spect</span><span class="p">[</span><span class="n">j</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>              <span class="c"># for thermal population: the frequency in initial state</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-44'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-44'>#</a>
      </div>
      <p>if lines[-1] &gt; 0.0001:
   print lines[-1], freqs[-1]</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="n">result</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">lines</span><span class="p">)</span> <span class="p">))</span>
   <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">freqs</span>
   <span class="n">T</span><span class="o">*=</span><span class="n">Hartree2cm_1</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-45'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-45'>#</a>
      </div>
      <p>result[2]=[42 for i in range(len(result[2]))]
result[1]=[lines[i]<em>lines[i]</em>np.exp(-initF[i]/T)/10 for i in range(len(result[1]))]  # devide by ten since I_00 is 10 not 100 (should be square)</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>   <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">])):</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-46'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-46'>#</a>
      </div>
      <p>arbitrary but constant number for mode</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre>      <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="mi">42</span>
      <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">lines</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">initF</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">T</span><span class="p">)</span> <span class="c">#thermally weighting of transitions</span>
   <span class="k">print</span> <span class="n">result</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="n">Energy</span><span class="o">*</span><span class="n">Hartree2cm_1</span><span class="p">,</span> <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
   <span class="k">return</span> <span class="n">result</span>

<span class="n">version</span><span class="o">=</span><span class="mf">0.6</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-47'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-47'>#</a>
      </div>
      <p>End of Dusch_unrest.py</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>
</body>
